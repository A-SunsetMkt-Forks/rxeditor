{"version":3,"sources":["../src/createEngine.ts"],"sourcesContent":["import type { Store } from 'redux'\nimport { configureStore } from '@reduxjs/toolkit'\nimport { reduce, State } from './reducers'\nimport { IDesignerEngine } from './interfaces'\nimport { Monitor } from './classes/Monitor'\nimport { DesignerEngine } from './classes/DesignerEngine'\nimport { DesignerShell } from './shell'\nimport { rootBehavior } from './behaviors/rootBehavior'\nimport { IPluginFactory } from './interfaces/plugin'\n\nexport function createEngine(\n\tplugins: IPluginFactory[],\n\toptions: {\n\t\tlanguange?: string,\n\t\tdebugMode: boolean,\n\t} = {\n\t\t\tdebugMode: false\n\t\t},\n): IDesignerEngine {\n\tconst store = makeStoreInstance(options.debugMode)\n\tconst monitor = new Monitor(store)\n\tconst shell = new DesignerShell()\n\tconst engine = new DesignerEngine(store, shell, monitor, plugins)\n\tengine.getComponentManager().registerBehaviors(rootBehavior)\n\treturn engine\n}\n\nfunction makeStoreInstance(debugMode: boolean): Store<State> {\n\t// TODO: if we ever make a react-native version of this,\n\t// we'll need to consider how to pull off dev-tooling\n\tconst reduxDevTools =\n\t\ttypeof window !== 'undefined' &&\n\t\t(window as any).__REDUX_DEVTOOLS_EXTENSION__\n\treturn configureStore(\n\t\t{\n\t\t\treducer: reduce,\n\t\t\tmiddleware: (getDefaultMiddleware) => getDefaultMiddleware({\n\t\t\t\timmutableCheck: false,\n\t\t\t\tserializableCheck: false,\n\t\t\t}),\n\t\t\tdevTools: debugMode &&\n\t\t\t\treduxDevTools &&\n\t\t\t\treduxDevTools({\n\t\t\t\t\tname: 'dnd-core',\n\t\t\t\t\tinstanceId: 'dnd-core',\n\t\t\t\t}),\n\t\t}\n\t)\n}\n"],"names":["configureStore","reduce","Monitor","DesignerEngine","DesignerShell","rootBehavior","createEngine","plugins","options","debugMode","store","makeStoreInstance","monitor","shell","engine","getComponentManager","registerBehaviors","reduxDevTools","window","__REDUX_DEVTOOLS_EXTENSION__","reducer","middleware","getDefaultMiddleware","immutableCheck","serializableCheck","devTools","name","instanceId"],"mappings":"AACA,SAASA,cAAc,QAAQ,mBAAkB;AACjD,SAASC,MAAM,QAAe,aAAY;AAE1C,SAASC,OAAO,QAAQ,oBAAmB;AAC3C,SAASC,cAAc,QAAQ,2BAA0B;AACzD,SAASC,aAAa,QAAQ,UAAS;AACvC,SAASC,YAAY,QAAQ,2BAA0B;AAGvD,OAAO,SAASC,aACfC,OAAyB,EACzBC,UAGI;IACFC,WAAW,KAAK;AACjB,CAAC,EACgB;IAClB,MAAMC,QAAQC,kBAAkBH,QAAQC,SAAS;IACjD,MAAMG,UAAU,IAAIV,QAAQQ;IAC5B,MAAMG,QAAQ,IAAIT;IAClB,MAAMU,SAAS,IAAIX,eAAeO,OAAOG,OAAOD,SAASL;IACzDO,OAAOC,mBAAmB,GAAGC,iBAAiB,CAACX;IAC/C,OAAOS;AACR,CAAC;AAED,SAASH,kBAAkBF,SAAkB,EAAgB;IAC5D,wDAAwD;IACxD,qDAAqD;IACrD,MAAMQ,gBACL,OAAOC,WAAW,eAClB,AAACA,OAAeC,4BAA4B;IAC7C,OAAOnB,eACN;QACCoB,SAASnB;QACToB,YAAY,CAACC,uBAAyBA,qBAAqB;gBAC1DC,gBAAgB,KAAK;gBACrBC,mBAAmB,KAAK;YACzB;QACAC,UAAUhB,aACTQ,iBACAA,cAAc;YACbS,MAAM;YACNC,YAAY;QACb;IACF;AAEF"}