{"version":3,"sources":["../../../../src/auxwidgets/toolbar/controls/Selector.ts"],"sourcesContent":["import { AUX_BACKGROUND_COLOR, AUX_COLOR, TOOLBAR_HEIGHT } from \"../../consts\";\r\nimport { ID, IDesignerEngine, ITreeNode } from \"../../../interfaces\";\r\nimport { IAuxControl } from \"../interfaces\";\r\n\r\nexport class ComponentSelector implements IAuxControl {\r\n  name: string = \"default.component-selector\";\r\n  private htmlElement: HTMLElement\r\n  private menuDiv: HTMLElement\r\n  private items = 0\r\n  constructor(protected engine: IDesignerEngine) {\r\n    const htmlDiv = document.createElement('div')\r\n    htmlDiv.style.backgroundColor = AUX_BACKGROUND_COLOR\r\n    htmlDiv.style.color = AUX_COLOR\r\n    htmlDiv.style.padding = \"0 4px\"\r\n    htmlDiv.style.borderRadius = \"2px\"\r\n    htmlDiv.style.cursor = \"pointer\"\r\n    htmlDiv.style.position = \"relative\"\r\n    htmlDiv.style.display = \"flex\"\r\n    htmlDiv.style.alignItems = \"center\"\r\n    htmlDiv.style.height = TOOLBAR_HEIGHT + \"px\"\r\n    const menuDiv = document.createElement('div')\r\n    menuDiv.style.position = \"absolute\"\r\n    menuDiv.style.left = \"0px\"\r\n    menuDiv.style.top = \"100%\"\r\n    menuDiv.style.height = \"0\"\r\n    menuDiv.style.overflow = \"hidden\"\r\n    menuDiv.style.transition = \"all 0.3s\"\r\n    this.menuDiv = menuDiv\r\n    this.htmlElement = htmlDiv\r\n    this.htmlElement.addEventListener(\"mouseenter\", this.handleMouseEnter)\r\n    this.htmlElement.addEventListener(\"mouseleave\", this.handleMouseLeave)\r\n  }\r\n  selector(node: ITreeNode, engine?: IDesignerEngine | undefined) {\r\n    return true\r\n  }\r\n  onRender(node: ITreeNode): HTMLElement | null {\r\n    this.htmlElement.innerHTML = ` \r\n    <svg style=\"width:14px;height:14px;margin-right:2px\" viewBox=\"0 0 24 24\">\r\n      <path fill=\"currentColor\" d=\"M22,13.5C22,15.26 20.7,16.72 19,16.96V20A2,2 0 0,1 17,22H13.2V21.7A2.7,2.7 0 0,0 10.5,19C9,19 7.8,20.21 7.8,21.7V22H4A2,2 0 0,1 2,20V16.2H2.3C3.79,16.2 5,15 5,13.5C5,12 3.79,10.8 2.3,10.8H2V7A2,2 0 0,1 4,5H7.04C7.28,3.3 8.74,2 10.5,2C12.26,2 13.72,3.3 13.96,5H17A2,2 0 0,1 19,7V10.04C20.7,10.28 22,11.74 22,13.5M17,15H18.5A1.5,1.5 0 0,0 20,13.5A1.5,1.5 0 0,0 18.5,12H17V7H12V5.5A1.5,1.5 0 0,0 10.5,4A1.5,1.5 0 0,0 9,5.5V7H4V9.12C5.76,9.8 7,11.5 7,13.5C7,15.5 5.75,17.2 4,17.88V20H6.12C6.8,18.25 8.5,17 10.5,17C12.5,17 14.2,18.25 14.88,20H17V15Z\" />\r\n    </svg>\r\n    ${node.title || node.meta.componentName} \r\n    `\r\n    this.htmlElement.appendChild(this.menuDiv)\r\n    this.menuDiv.innerHTML = \"\"\r\n    this.items = 0\r\n    node.parentId && this.creatParentItem(node.parentId)\r\n    return this.htmlElement\r\n  }\r\n\r\n  handleMouseEnter = () => {\r\n    this.menuDiv.style.height = (this.items * (TOOLBAR_HEIGHT + 2)) + \"px\"\r\n  }\r\n\r\n  handleMouseLeave = () => {\r\n    this.menuDiv.style.height = \"0\"\r\n  }\r\n\r\n  teardown(): void {\r\n    this.htmlElement.removeEventListener(\"mouseenter\", this.handleMouseEnter)\r\n    if (this.htmlElement) {\r\n      this.htmlElement.remove()\r\n    }\r\n  }\r\n\r\n  private creatParentItem(parentId: ID) {\r\n    const parentNode = this.engine.getMonitor().getNode(parentId)\r\n    this.items = this.items + 1\r\n    const itemDiv = document.createElement('div')\r\n    itemDiv.style.backgroundColor = AUX_BACKGROUND_COLOR\r\n    itemDiv.style.marginTop = \"2px\"\r\n    itemDiv.style.padding = \"0px 4px\"\r\n    itemDiv.style.borderRadius = \"2px\"\r\n    itemDiv.style.display = \"flex\"\r\n    itemDiv.style.alignItems = \"center\"\r\n    itemDiv.style.height = TOOLBAR_HEIGHT + \"px\"\r\n    itemDiv.innerHTML = `\r\n    <svg style=\"width:14px;height:14px;margin-right:2px\" viewBox=\"0 0 24 24\">\r\n      <path fill=\"currentColor\" d=\"M8 3H16C18.76 3 21 5.24 21 8V16C21 18.76 18.76 21 16 21H8C5.24 21 3 18.76 3 16V8C3 5.24 5.24 3 8 3M8 5C6.34 5 5 6.34 5 8V16C5 17.66 6.34 19 8 19H16C17.66 19 19 17.66 19 16V8C19 6.34 17.66 5 16 5H8Z\" />\r\n    </svg>\r\n    ${parentNode?.title || parentNode?.meta.componentName}\r\n    `\r\n    itemDiv.style.whiteSpace = \"nowrap\"\r\n    itemDiv.addEventListener(\"click\", ()=>{\r\n      this.menuDiv.style.height = \"0\"\r\n      parentNode && this.engine.getActions().selectNodes([parentId], parentNode?.documentId)\r\n    })\r\n    this.menuDiv.appendChild(itemDiv)\r\n\r\n    parentNode?.parentId && this.creatParentItem(parentNode.parentId)\r\n  }\r\n}"],"names":["AUX_BACKGROUND_COLOR","AUX_COLOR","TOOLBAR_HEIGHT","ComponentSelector","selector","node","engine","onRender","htmlElement","innerHTML","title","meta","componentName","appendChild","menuDiv","items","parentId","creatParentItem","teardown","removeEventListener","handleMouseEnter","remove","parentNode","getMonitor","getNode","itemDiv","document","createElement","style","backgroundColor","marginTop","padding","borderRadius","display","alignItems","height","whiteSpace","addEventListener","getActions","selectNodes","documentId","constructor","name","handleMouseLeave","htmlDiv","color","cursor","position","left","top","overflow","transition"],"mappings":"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"}